---
tags: [javascript, async, patterns, factory, frontend]
aliases: [–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –ó–∞–º—ã–∫–∞–Ω–∏—è –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å]
---

# üß∞ –ü–æ–¥—Ö–æ–¥—ã –∫ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ –≤ JavaScript

> –ü–æ–¥–±–æ—Ä–∫–∞ –∏–∑ 5 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∑–∞–º—ã–∫–∞–Ω–∏—è, —Å –∞–Ω–∞–ª–æ–≥–∏—è–º–∏ –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---

## üêé –ö–æ–Ω—Ç—Ä–æ–ª—å –≥–æ–Ω–∫–∏ (Race Condition Controller)

**–°—É—Ç—å:** —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–∑–æ–≤ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

**–ê–Ω–∞–ª–æ–≥–∏—è:** –Ω–∞—á–∞–ª–∞ –±–µ–∂–∞—Ç—å –ª–æ—à–∞–¥—å, –∏ –∫–æ–≥–¥–∞ –Ω–∞ –ø–æ–ª–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–∞—è, —Ç–∞, —á—Ç–æ —É–∂–µ –±–µ–∂–∏—Ç, –¥–∏—Å–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è. –û–Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç –±–µ–∂–∞—Ç—å, –Ω–æ –Ω–µ –±—É–¥–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å—Å—è.

**–ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, live search.

**–ù—é–∞–Ω—Å—ã:** –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ —Ñ–æ–Ω–µ, –Ω–æ –Ω–µ –≤–æ–∑—ã–º–µ–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∞, —á—Ç–æ –º–æ–∂–µ—Ç —Å–∫–∞–∑–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

```ts
function createRacingRequest() {
  let currentToken = 0;

  return async function (fn) {
    const token = ++currentToken;
    const result = await fn();
    return token === currentToken ? result : undefined;
  };
}

// –ü—Ä–∏–º–µ—Ä:
const raceRequest = createRacingRequest();
await raceRequest(() => fetchData());
```

---

## üóÉÔ∏è –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (Query Containers / –ö–µ—à –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º)

**–°—É—Ç—å:** —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–∫–ª—é—á) –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã–π —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏.

**–ê–Ω–∞–ª–æ–≥–∏—è:** –ª–æ—à–∞–¥–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏ –±–µ–≥—É—Ç –≤ —Å–≤–æ–∏ –±–æ–∫—Å—ã. –ü–æ–±–µ–¥–∏—Ç–µ–ª—å ‚Äî –∫–∞–∂–¥–∞—è –≤ —Å–≤–æ—ë–º –∫–ª–∞—Å—Å–µ. –ï—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ –Ω–æ–º–µ—Ä–æ–º ‚Äî –æ–Ω–∏ –º–æ–≥—É—Ç –Ω–∞—á–∞—Ç—å –∫–æ–Ω–∫—É—Ä–∏—Ä–æ–≤–∞—Ç—å (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ–Ω–∫–∏).

**–ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤, –ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã.

**–ù—é–∞–Ω—Å—ã:** –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –∫–ª—é—á –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å. –í–æ–∑–º–æ–∂–Ω—ã –≥–æ–Ω–∫–∏ –º–µ–∂–¥—É –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏.

```ts
function createQueryCache() {
  const cache = new Map();

  return function (key, fn) {
    if (!cache.has(key)) {
      const promise = fn();
      cache.set(key, promise);
    }
    return cache.get(key);
  };
}

// –ü—Ä–∏–º–µ—Ä:
const getQuery = createQueryCache();
const data = await getQuery("user:1", () => fetchUser(1));
```

---

## üí£ AbortController ‚Äî –æ—Ç–º–µ–Ω—è–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ

**–°—É—Ç—å:** –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –ª—é–±–æ–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏ –æ–ø–æ–≤–µ—Å—Ç–∏—Ç—å –≤—Å–µ—Ö —Å–ª—É—à–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ `AbortSignal`.

**–ê–Ω–∞–ª–æ–≥–∏—è:** –ª–æ—à–∞–¥—å —Å –¥–µ—Ç–æ–Ω–∞—Ç–æ—Ä–æ–º –Ω–∞ —Å–ø–∏–Ω–µ. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–æ–≤–æ–π ‚Äî —Å—Ç–∞—Ä–∞—è –≤–∑—Ä—ã–≤–∞–µ—Ç—Å—è. –ù–æ–≤–∞—è –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –¥–µ—Ç–æ–Ω–∞—Ç–æ—Ä, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–æ–±–µ–∂–∞–ª–∞ –ø–µ—Ä–≤–æ–π.

**–ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –æ—Ç–º–µ–Ω–∞ –ø—Ä–∏ –¥–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –æ—Ç–º–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

**–ù—é–∞–Ω—Å—ã:** –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö —Ç–∏–ø–∞ axios –Ω—É–∂–Ω–æ –ª–æ–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –æ—à–∏–±–∫—É `httpAbortedError`.

```ts
function withAbortable(fn) {
  return (signal, ...args) => {
    return new Promise((resolve, reject) => {
      if (signal.aborted) return reject(new Error("Aborted"));

      const onAbort = () => reject(new Error("Aborted"));
      signal.addEventListener("abort", onAbort);

      fn(...args)
        .then(resolve)
        .catch(reject)
        .finally(() => {
          signal.removeEventListener("abort", onAbort);
        });
    });
  };
}

// –ü—Ä–∏–º–µ—Ä:
const controller = new AbortController();
const fetchWithAbort = withAbortable(fetchData);
fetchWithAbort(controller.signal, ...args);
```

---

## üîí –ú–µ—Ö–∞–Ω–∏–∑–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (Lock / Mutex)

**–°—É—Ç—å:** –µ—Å–ª–∏ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –∑–∞–ø—É—â–µ–Ω ‚Äî –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∂–¥—É—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è.

**–ê–Ω–∞–ª–æ–≥–∏—è:** –ª–æ—à–∞–¥—å –Ω–∞ —Ç—Ä–µ–∫–µ –æ–¥–Ω–∞, –≤–æ—Ä–æ—Ç–∞ –∑–∞–∫—Ä—ã—Ç—ã. –û—Å—Ç–∞–ª—å–Ω—ã–µ –∂–¥—É—Ç –∏–ª–∏ –Ω–µ –≤—ã—Ö–æ–¥—è—Ç.

**–ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –¥–µ–π—Å—Ç–≤–∏—è —Å debounce, –∑–∞–ø—Ä–µ—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã.

**–ù—é–∞–Ω—Å—ã:** –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–±—Ä–æ—Å–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—Ä—É—á–Ω—É—é ‚Äî –Ω—É–∂–Ω–æ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

```ts
function createLockedRequest() {
  let locked = false;

  return async function (fn) {
    if (locked) return;
    locked = true;
    try {
      await fn();
    } finally {
      locked = false;
    }
  };
}

// –ü—Ä–∏–º–µ—Ä:
const lockedFetch = createLockedRequest();
await lockedFetch(() => fetchData());
```

---

## üßµ –¶–µ–ø–æ—á–∫–∞ –ø—Ä–æ–º–∏—Å–æ–≤ (Promise Chain)

**–°—É—Ç—å:** –≤—Å–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∏–¥—É—Ç —Å—Ç—Ä–æ–≥–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –≤—ã–∑–≤–∞–Ω—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

**–ê–Ω–∞–ª–æ–≥–∏—è:** –ª–æ—à–∞–¥–∏ –∏–¥—É—Ç –¥—Ä—É–≥ –∑–∞ –¥—Ä—É–≥–æ–º. –°–ª–µ–¥—É—é—â–∞—è –º–æ–∂–µ—Ç —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–π.

**–ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –º–∞—Å—Ç–µ—Ä–∞, —à–∞–≥–∏ —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é, –æ—á–µ—Ä–µ–¥—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã.

```ts
function createPromiseChain() {
  let chain = Promise.resolve();

  return function (fn) {
    chain = chain.then(fn).catch(console.error);
    return chain;
  };
}

// –ü—Ä–∏–º–µ—Ä:
const enqueue = createPromiseChain();
enqueue(() => fetchStep1());
enqueue(() => fetchStep2());
```

---

## ‚úÖ –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ü–æ–¥—Ö–æ–¥           | –§–∞–±—Ä–∏–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏         | –ì–∞—Ä–∞–Ω—Ç–∏–∏                                    | –ì–¥–µ –ø—Ä–∏–º–µ–Ω–∏–º     | –ê–Ω–∞–ª–æ–≥–∏—è                             |
| ---------------- | ----------------------- | ------------------------------------------- | ---------------- | ------------------------------------ |
| Race Condition   | `createRacingRequest()` | –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å         | UI/–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ | –ù–æ–≤–∞—è –ª–æ—à–∞–¥—å –¥–∏—Å–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—É—é |
| Query Containers | `createQueryCache()`    | –ö–µ—à –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ        | UI/–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ | –ö–∞–∂–¥–∞—è –ª–æ—à–∞–¥—å –≤ —Å–≤–æ–π –±–æ–∫—Å            |
| Abort Controller | `withAbortable(fn)`     | –û—Ç–º–µ–Ω–∞ —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞–ª, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–ª—É—à–∞—Ç–µ–ª–µ–π | UI/–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ | –õ–æ—à–∞–¥–∏ —Å –¥–µ—Ç–æ–Ω–∞—Ç–æ—Ä–æ–º                 |
| Lock             | `createLockedRequest()` | –ó–∞–ø—Ä–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤                    | UI/–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ | –í–æ—Ä–æ—Ç–∞ –∑–∞–∫—Ä—ã—Ç—ã ‚Äî –∂–¥—ë–º                |
| Promise Chain    | `createPromiseChain()`  | –°—Ç—Ä–æ–≥–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è       | –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞    | –û–¥–Ω–∞ –∑–∞ –¥—Ä—É–≥–æ–π                       |
