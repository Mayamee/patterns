# `sample` –∏ `audit` ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª—è —á–∞—Å—Ç–æ—Ç—ã —Å–æ–±—ã—Ç–∏–π

–û–±–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–º —Å–æ–±—ã—Ç–∏–π, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–±—ã—Ç–∏—è –º—ã—à–∏, –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à, –≤–µ–±—Å–æ–∫–µ—Ç—ã –∏ —Ç.–ø.). –ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω–æ, –∫–∞–∫ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç, –≤ —á—ë–º —Ä–∞–∑–ª–∏—á–∏–µ –∏ –∫–∞–∫ –∏—Ö —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞ —á–∏—Å—Ç–æ–º JavaScript.

---

## üß™ `sample`

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

–û–ø–µ—Ä–∞—Ç–æ—Ä `sample` –±–µ—Ä–µ—Ç **–ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** –∏–∑ –ø–æ—Ç–æ–∫–∞ —Å–æ–±—ã—Ç–∏–π, –Ω–æ —ç–º–∏—Ç–∏—Ç –µ–≥–æ **—Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥—Ä—É–≥–æ–π —Ç—Ä–∏–≥–≥–µ—Ä** ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–∞–π–º–µ—Ä.

–ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:

> ¬´–ë–µ—Ä–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–π –µ–≥–æ –Ω–∞—Ä—É–∂—É —Ç–æ–ª—å–∫–æ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é¬ª.

### –ö–∞–∫—É—é –ø–æ–ª—å–∑—É –¥–∞—ë—Ç, –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å

- –ö–æ–Ω—Ç—Ä–æ–ª—å —á–∞—Å—Ç–æ—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø–æ–∑–∏—Ü–∏—é –º—ã—à–∏, –Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ 1 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É.
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è UI-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π, –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–æ –Ω–µ —Ç–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ, –Ω–æ –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏.

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

```ts
function sample(source, trigger, callback) {
  let latestValue;
  let hasValue = false;

  const sourceUnsub = source((value) => {
    latestValue = value;
    hasValue = true;
  });

  const triggerUnsub = trigger(() => {
    if (hasValue) {
      callback(latestValue);
      hasValue = false;
    }
  });

  return () => {
    sourceUnsub();
    triggerUnsub();
  };
}

// --- –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ---
function source(emitter) {
  const id = setInterval(() => emitter(Date.now()), 500); // –∫–∞–∂–¥—ã–µ 500ms
  return () => clearInterval(id);
}

function trigger(emitter) {
  const id = setInterval(() => emitter(), 2000); // –∫–∞–∂–¥—ã–µ 2s
  return () => clearInterval(id);
}

sample(source, trigger, (val) => {
  console.log("[sample]", val);
});
```

---

## üéØ `audit`

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

–û–ø–µ—Ä–∞—Ç–æ—Ä `audit` –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ **–∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–∞–π–º–µ—Ä**. –í—Å–µ —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è —Ç–∞–π–º–µ—Ä–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è, –Ω–æ **–ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è**. –ö–æ–≥–¥–∞ —Ç–∞–π–º–µ—Ä –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è ‚Äî –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

–ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:

> ¬´–û–±—Ä–∞–±–æ—Ç–∞–π —Ç–æ–ª—å–∫–æ **–ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** –ø–æ—Å–ª–µ –ø–∞—É–∑—ã –≤ N –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥¬ª.

### –ö–∞–∫—É—é –ø–æ–ª—å–∑—É –¥–∞—ë—Ç, –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å

- –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –ø—Ä–∏ ¬´—à—É–º–Ω—ã—Ö¬ª –ø–æ—Ç–æ–∫–∞—Ö.
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–ª—É—á–∞–µ–≤, –≥–¥–µ –≤–∞–∂–Ω–æ –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–±—ã—Ç–∏–µ, –Ω–æ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å—ë –ø–æ–¥—Ä—è–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–∫—Ä—É—Ç–∫–∞, resize, —Å–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ –º—ã—à–∏ –∏ —Ç.–ø.).
- –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç `throttle`, –≤—Å–µ–≥–¥–∞ –±–µ—Ä—ë—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–µ –ø–µ—Ä–≤–æ–µ).

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

```ts
function audit(source, durationFn, callback) {
  let lastValue;
  let isThrottling = false;

  const sourceUnsub = source((value) => {
    lastValue = value;

    if (!isThrottling) {
      isThrottling = true;

      const stop = durationFn(() => {
        callback(lastValue);
        isThrottling = false;
      });
    }
  });

  return () => {
    sourceUnsub();
  };
}

// --- –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ---
function source(emitter) {
  const id = setInterval(() => emitter(Date.now()), 500); // —Å–æ–±—ã—Ç–∏—è –∫–∞–∂–¥—ã–µ 500ms
  return () => clearInterval(id);
}

function durationFn(done) {
  const id = setTimeout(done, 3000); // 3 —Å–µ–∫—É–Ω–¥—ã
  return () => clearTimeout(id);
}

audit(source, durationFn, (val) => {
  console.log("[audit]", val);
});
```

---

## üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ `sample` –∏ `audit`

| –û–ø–µ—Ä–∞—Ç–æ—Ä | –ö–æ–≥–¥–∞ —ç–º–∏—Ç–∏—Ç                                | –ß—Ç–æ –ø–µ—Ä–µ–¥–∞—ë—Ç                    | –¢–∏–ø–∏—á–Ω—ã–π –∫–µ–π—Å                 |
| -------- | ------------------------------------------- | ------------------------------- | ----------------------------- |
| sample   | –ü–æ –≤–Ω–µ—à–Ω–µ–º—É —Ç—Ä–∏–≥–≥–µ—Ä—É (—Ç–∞–π–º–µ—Ä, –∫–ª–∏–∫)         | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI 1 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É |
| audit    | –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–∞—É–∑—ã (—Ç–∞–π–º–µ—Ä–∞) –ø–æ—Å–ª–µ —Å–æ–±—ã—Ç–∏—è | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞ –ø–∞—É–∑—É     | –†–µ–¥–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ resize  |

---

## üß© –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- –û–±–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –æ—Ç–ª–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è —á–µ—Ä–µ–∑ RxJS (`sample`, `audit`).
- –í MobX, React –∏ –¥—Ä—É–≥–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö –º–æ–∂–Ω–æ –¥–æ–±–∏—Ç—å—Å—è —Å—Ö–æ–∂–µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å `reaction`, `autorun`, `throttle`, `debounce`.
